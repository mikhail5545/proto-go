syntax = "proto3";

package course.v1;

import "product_service/product/v0/product.proto";
import "product_service/variant/v0/variant.proto";

import "google/protobuf/field_mask.proto";
import "google/protobuf/empty.proto";

option go_package = "github.com/mikhail5545/proto-go/proto/product_service/course/v1;coursepb";

message CreateRequest{
    string title = 1;
    optional string slug = 2;
    optional string subtitle = 3;
    string short_description = 4;
    repeated string tags = 5;
    bytes admin_uuid = 6;
    string admin_name = 7;
    string note = 8;
}

message CreateResponse{
    product.v0.Product product = 1;
}

message UpdateRequest{
    bytes uuid = 1;
    optional string title = 2;
    optional string slug = 3;
    bool regenerate_slug = 4;
    optional string subtitle = 5;
    optional string description = 6;
    optional string short_description = 7;
    repeated string tags = 8;
    optional string metadata = 9;
    optional string meta_title = 10;
    optional string meta_description = 11;
    optional google.protobuf.FieldMask updates = 12;
}

message UpdateResponse{
    bytes uuid = 1;
    optional string title = 2;
    optional string slug = 3;
    optional string subtitle = 4;
    optional string description = 5;
    optional string short_description = 6;
    repeated string tags = 7;
    optional string metadata = 8;
    optional string meta_title = 9;
    optional string meta_description = 10;
    optional google.protobuf.FieldMask updates = 11;
}

message CreateVariantRequest{
    bytes product_uuid = 1;
    string title = 2;
    string sku = 3;
    optional int32 download_limit = 4;

    optional string option1 = 5;
    optional string option2 = 6;
    optional string option3 = 7;

    optional int32 access_duration_days = 8;

    bytes admin_uuid = 9;
    string admin_name = 10;
    string note = 11;
}

message CreateVariantResponse{
    variant.v0.Variant variant = 1;
}

message UpdateVariantRequest{
    bytes variant_uuid = 1;
    bytes product_uuid = 2;
    optional string title = 3;
    optional string sku = 4;
    bool regenerate_sku = 5;

    optional variant.v0.VariantInventoryPolicy inventory_policy = 6;
    optional bool allow_backorder = 7;
    
    optional string option1 = 8;
    optional string option2 = 9;
    optional string option3 = 10;

    optional int32 download_limit = 11;
    optional int32 access_duration_days = 12;
    optional google.protobuf.FieldMask updates = 13;
}

message UpdateVariantResponse{
    bytes variant_uuid = 1;
    bytes product_uuid = 2;
    optional string title = 3;
    optional string sku = 4;

    optional variant.v0.VariantInventoryPolicy inventory_policy = 5;
    optional bool allow_backorder = 6;
    
    optional string option1 = 7;
    optional string option2 = 8;
    optional string option3 = 9;

    optional int32 download_limit = 10;
    optional int32 access_duration_days = 11;
    optional google.protobuf.FieldMask updates = 12;
}

message ChangeStateRequest {
    bytes uuid = 1;
    bytes admin_uuid = 2;
    string admin_name = 3;
    string note = 4;
}

message PingResponse {
    int64 timestamp = 1;
}

service CourseService{
    rpc Ping(google.protobuf.Empty) returns (PingResponse) {}
    rpc Create(CreateRequest) returns (CreateResponse) {}
    rpc Update(UpdateRequest) returns (UpdateResponse) {}
    rpc CreateVariant(CreateVariantRequest) returns (CreateVariantResponse) {}
    rpc UpdateVariant(UpdateVariantRequest) returns (UpdateVariantResponse) {}
    rpc Publish(ChangeStateRequest) returns (google.protobuf.Empty) {}
    rpc Archive(ChangeStateRequest) returns (google.protobuf.Empty) {}
}